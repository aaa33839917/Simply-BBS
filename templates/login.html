{% extends 'base.html' %}

{% block title %}登录{% endblock %}

{% block content %}
            <section class="auth-section">
                <h2>用户登录</h2>
                
                <!-- 选择登录方式 -->
                <div id="step0" class="login-step active">
                    <h3>选择登录方式</h3>
                    <div class="login-options">
                        <button id="nameLoginBtn" class="login-option-btn">
                            <h4>用户名登录</h4>
                            <p>通过用户名登录，支持选择同名用户</p>
                        </button>
                        <button id="idLoginBtn" class="login-option-btn">
                            <h4>ID登录</h4>
                            <p>直接通过用户ID登录，快速便捷</p>
                        </button>
                    </div>
                </div>
                
                <!-- 用户名登录流程：第一步输入用户名 -->
                <div id="step1" class="login-step">
                    <form id="usernameForm" class="auth-form">
                        <div class="form-group">
                            <label for="username">用户名:</label>
                            <input type="text" id="username" name="username" required placeholder="请输入用户名">
                            <small>输入用户名后，系统会检测是否有相同名称的用户</small>
                        </div>
                        <button type="submit" class="submit-btn">下一步</button>
                        <button id="backToOption1" class="back-btn">返回</button>
                    </form>
                </div>
                
                <!-- 用户名登录流程：第二步选择用户 -->
                <div id="step2" class="login-step">
                    <h3>选择用户</h3>
                    <div class="user-search">
                        <input type="text" id="idSearch" placeholder="输入ID搜索（模糊匹配）">
                    </div>
                    <div id="usersList" class="users-list">
                        <!-- 用户列表将通过JavaScript动态生成 -->
                    </div>
                    <button id="backBtn" class="back-btn">返回</button>
                </div>
                
                <!-- ID登录流程：直接输入ID和密码 -->
                <div id="step4" class="login-step">
                    <form id="idLoginForm" class="auth-form">
                        <div class="form-group">
                            <label for="loginId">用户ID:</label>
                            <input type="number" id="loginId" name="user_id" required placeholder="请输入用户ID">
                            <small>输入您的用户ID，直接登录</small>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">密码:</label>
                            <input type="password" id="loginPassword" name="password" required placeholder="请输入密码">
                        </div>
                        <button type="submit" class="submit-btn">登录</button>
                        <button id="backToOption2" class="back-btn">返回</button>
                    </form>
                </div>
                
                <!-- 第三步：输入密码 -->
                <div id="step3" class="login-step">
                    <h3>登录用户: <span id="selectedUsername"></span> (ID: <span id="selectedUserId"></span>)</h3>
                    <form id="passwordForm" class="auth-form">
                        <input type="hidden" id="selectedUser" name="user_id">
                        <div class="form-group">
                            <label for="password">密码:</label>
                            <input type="password" id="password" name="password" required placeholder="请输入密码">
                        </div>
                        <button type="submit" class="submit-btn">登录</button>
                        <button id="backToSelect" class="back-btn">返回选择</button>
                    </form>
                </div>
                
                <div class="auth-link">
                    还没有账号？<a href="{{ url_for('register_page') }}">立即注册</a>
                </div>
            </section>
{% endblock %}